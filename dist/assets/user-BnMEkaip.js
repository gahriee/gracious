import{a as c}from"./index-B9ygI19o.js";function p(a,e,t,n){let o,i;e<=3?(o=1,i=e):(o=Math.max(1,a-Math.floor(3/2)),i=o+3-1,i>e&&(i=e,o=i-3+1)),t.empty(),t.append(a>1?`<button class="pagination-link" data-page="${a-1}">Previous</button>`:'<button class="pagination-link disabled" disabled>Previous</button>');for(let s=o;s<=i;s++){const f=s===a?"active":"";t.append(`
            <button class="pagination-link ${f}" data-page="${s}">${s}</button>
        `)}t.append(a<e?`<button class="pagination-link" data-page="${a+1}">Next</button>`:'<button class="pagination-link disabled" disabled>Next</button>')}function v(a,e,t){e.empty(),a.length===0?e.append(`
            <tr>
                <td colspan="6">No Users Found</td>
            </tr>
        `):a.forEach(n=>{const d=new Date(n.created_at).toISOString().split("T")[0],o=`
            <tr>
                <td>${n.id}</td>
                <td>${n.first_name} ${n.last_name}</td>
                <td>${n.username}</td>
                <td>${n.number}</td>
                <td>${n.status}</td>
                <td>${d}</td>
                <td>
                    ${t(n.id)}
                </td>
            </tr>
            `;e.append(o)})}function r(a=1,e=""){c.post(`/admin/users/populate?page=${a}&search=${e}`).then(t=>{const n=t.data.data,d=$("#userTableBody"),o=$("#activePagination");v(n,d,i=>`
                <button data-id="${i}" class="edit-btn">Edit</button>
                <button data-id="${i}" class="deactivate-btn">Deactivate</button>
            `),p(t.data.current_page,t.data.last_page,o)}).catch(t=>console.error("Error fetching active users!",t))}function l(a=1,e=""){c.post(`/admin/users/populateDeactivated?page=${a}&search=${e}`).then(t=>{const n=t.data.data,d=$("#deactivatedUserTableBody"),o=$("#deactivatedPagination");v(n,d,i=>`
                <button data-id="${i}" class="activate-btn">Activate</button>
            `),p(t.data.current_page,t.data.last_page,o)}).catch(t=>console.error("Error fetching deactivated users!",t))}function u(a,e){if(a.response&&a.response.status===422){const t=a.response.data.errors;e.empty().show(),Object.values(t).forEach(n=>{n.forEach(d=>{e.append(`<li>${d}</li>`)})})}else console.error("Error:",a)}$(document).ready(()=>{r(),l(),$("#activeSearchInput").on("input",function(){const a=$(this).val();r(1,a)}),$("#deactiveSearchInput").on("input",function(){const a=$(this).val();l(1,a)}),$(document).on("click",".pagination-link",function(){const a=$(this).data("page"),e=$("#searchInput").val();$(this).hasClass("disabled")||($(this).closest("#activePagination").length>0?r(a,e):l(a,e))}),$("#add-btn").on("click",function(){$("#addForm")[0].reset(),$("#validation-errors").empty().hide(),$("#addModal").fadeIn().css("display","flex")}),$(document).on("click",".edit-btn",function(){$("#update-errors").empty().hide();const a=$(this).data("id");c.get(`/admin/user/fetch/${a}`).then(e=>{const t=e.data;$("#edit-user-id").val(t.id),$("#updateFirstname").val(t.first_name),$("#updateLastname").val(t.last_name),$("#updateUsername").val(t.username),$("#updateAge").val(t.age),$("#updateNumber").val(t.number),$("#updateStreetAddress").val(t.street_address),$("#updateProvince").val(t.province).trigger("change");const n=$("#updateCity"),d=t.city;fetch(`/account/cities/${t.province}`).then(o=>o.json()).then(o=>{n.empty().append('<option value="">Select City</option>'),o.forEach(i=>{const s=document.createElement("option");s.value=i.id,s.textContent=i.name,n.append(s)}),n.val(d)}).catch(o=>console.error("Error fetching cities:",o)),$("#updateCountry").val(t.country),$("#updateModal").fadeIn().css("display","flex")}).catch(e=>console.error("Error fetching user data:",e))}),$(document).on("click",".deactivate-btn",function(){const a=$(this).data("id");c.get(`/admin/user/fetch/${a}`).then(e=>{const t=e.data;t?($("#deactivate-user-id").val(t.id),$("#deactivate-username").text(t.username||"No username available"),$("#deactivateModal").fadeIn().css("display","flex")):console.error("No employee data found.")}).catch(e=>console.error("Error fetching employee data:",e))}),$(document).on("click",".activate-btn",function(){const a=$(this).data("id");c.get(`/admin/user/fetch/${a}`).then(e=>{const t=e.data;t?($("#activate-user-id").val(t.id),$("#activate-username").text(t.username||"No username available"),$("#activateModal").fadeIn().css("display","flex")):console.error("No employee data found.")}).catch(e=>console.error("Error fetching employee data:",e))}),$("#addForm").on("submit",function(a){a.preventDefault();const e=new FormData(this);c.post("/admin/user/store",e).then(()=>{r(),l(),$("#addModal").fadeOut(),alert("Patient added successfully!")}).catch(t=>u(t,$("#validation-errors")))}),$("#updateForm").on("submit",function(a){a.preventDefault();const e=new FormData(this);c.post("/admin/user/update",e).then(()=>{r(),l(),$("#activeSearchInput").val(""),$("#deactiveSearchInput").val(""),$("#updateModal").fadeOut(),alert("User updated successfully!")}).catch(t=>u(t,$("#update-errors")))}),$("#deactivateForm").on("submit",function(a){a.preventDefault();const e=new FormData(this);c.post("/admin/user/deactivate",e).then(()=>{r(),l(),$("#deactivateModal").fadeOut(),alert("Patient deactivated successfully!")}).catch(t=>u(t,$("#validation-errors")))}),$("#activateForm").on("submit",function(a){a.preventDefault();const e=new FormData(this);c.post("/admin/user/activate",e).then(()=>{r(),l(),$("#activateModal").fadeOut(),alert("Patient Activated successfully!")}).catch(t=>u(t,$("#validation-errors")))}),$("#add-close-modal").click(()=>$("#addModal").fadeOut()),$("#update-close-modal").click(()=>$("#updateModal").fadeOut()),$("#deactivate-close-modal").click(()=>$("#deactivateModal").fadeOut()),$("#activate-close-modal").click(()=>$("#activateModal").fadeOut())});
